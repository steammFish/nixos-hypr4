chrome.runtime.onMessage.addListener(function(a,b,c){"startLightbox"==a.action&&(closeScriptureLightbox(),chrome.storage.sync.get({useLightbox:!0},function(b){useLightbox=b.useLightbox;var d=a.greeting,f="https://chart.googleapis.com/chart?cht=qr&chs=320x320&chl="+d;!0==useLightbox?(background=document.createElement("div"),background.id="qrlightbox_background",lightbox=document.createElement("div"),lightbox.id="qrlightbox_extension",lightbox.innerHTML=`						<div id="boxcontent">							<img src="${f}" />							<div class="con__t" style="width: 254px;">								<h6><div>${a.pageTitle}</div></h6>							<input type="text" value="${d}" id="textfield">							<ul>								<li><a href="" id="__qr-btn_ShareIMGUR" title="Share to Imgur"><img src="${chrome.runtime.getURL("i/share.png")}" /></a></li>								<li class="__spt"></li>								<li><a title="close" id="__qr-btn-CloseWindow"><img src="${chrome.runtime.getURL("i/close.png")}" /></a></li>							</ul>							<div class="share-status_S__"></div>							</div>						</div>					`,document.body.appendChild(background),background.appendChild(lightbox),$(background).on("click","#__qr-btn-CloseWindow",closeScriptureLightbox),$(background).on("click","#__qr-btn_ShareIMGUR",function(a){return a.preventDefault(),$.ajax({url:"https://api.imgur.com/3/image",type:"POST",headers:{Authorization:"Client-ID b05d7c614638f9b",Accept:"application/json"},data:{image:f},success:function(a){const b=a.data.link;chrome.runtime.sendMessage({action:"qrAction.share.success",url:b}),$("#qrlightbox_extension .share-status").html("")},error:function(a){chrome.runtime.sendMessage({action:"qrAction.share.error",code:a.status}),$("#qrlightbox_extension .share-status_S__").html("Cannot upload to imgur...")}}),!1}),c({farewell:"goodbye"})):chrome.runtime.sendMessage({message:"open_new_tab",url:f})}))});function getTextValue(){return document.getElementById("textfield").value}function closeScriptureLightbox(){var a=document.getElementById("qrlightbox_background");null!==a&&(a.parentNode.removeChild(a),lightbox=!1)}window==top&&window.addEventListener("keyup",doKeyPress,!1);var trigger_key=27;function doKeyPress(a){a.keyCode==trigger_key&&closeScriptureLightbox()}chrome.extension.sendRequest({message:"report"},function(){});